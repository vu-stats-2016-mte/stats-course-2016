---
title: "Statistical Methods - Assignment 3"
author: "Michel Mooiweer (1866761) Thomas Webbers (2560695) Eirik Kultorp (2544992)"
date: "December 2016"
output: pdf_document
urlcolor: "blue"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
options(warn=-1)
```

# Theoretical exercises

## 4.1

    // todo

## 4.2 

    // todo

# R-Exercises

## 4.3

### a)

```{r 4.3a, echo=F}
dat=matrix(as.numeric(as.matrix(read.table("crimemale.txt"))[2:19,]),ncol=3)
age=dat[,1]
income=dat[,2]
crimes=dat[,3]

investigate_linear_correlation <- function(v1,v2,xlab,ylab){
  print(v1)
  print(v2)
  plot(v1,v2,xlab=xlab,ylab=ylab)
  corr=cor(v1,v2)
  print(paste("Correlation: (",xlab,",",ylab,")",corr))
  corr=abs(corr)
  
  # TODO adjust these thresholds based on statistical standards (if they exist) 
  
  if (corr<0.7) w ="unlikely"
  else if (corr<0.8) w = "plausible"
  else w="likely"
  print(paste("Linear correlation seems",w))
}

investigate_linear_correlation(age,crimes,"age","crimes")

```

### b)

```{r 4.3b, echo=F}
investigate_linear_correlation(income,crimes,"income","crimes")
```

### c)

    // todo figure how to interpret this output and the plots
    // based on https://www.r-bloggers.com/simple-linear-regression-2/

```{r 4.3c, echo=F}
lmres = lm(crimes ~ income)
summary(lmres)
library("lattice")
xyplot(resid(lmres) ~ fitted(lmres),
  xlab = "Fitted Values",
  ylab = "Residuals",
  main = "Residual Diagnostic Plot",
  panel = function(x, y, ...)
  {
    panel.grid(h = -1, v = -1)
    panel.abline(h = 0)
    panel.xyplot(x, y, ...)
  }
)
qqmath( ~ resid(lmres),
  xlab = "Theoretical Quantiles",
  ylab = "Residuals"
)
```

### d)

```{r 4.3d, echo=F}
```

### e)

```{r 4.3e, echo=F}
```

## 4.4

### a)

```{r 4.4a, echo=F}
```

### b)

```{r 4.4b, echo=F}
```

## 4.5

### a)

Because we are interested in if each 'subgroup' (which contain the result against one person) follow the same distribution of win, loss, draw we do a test of homeogenity.

- $\ H_0 = \text{andy performs equally well against all opponents}$\
- $\ H_a =\text{andy does not perform equally well against all opponents}$\
```{r 4.5a, echo=F}

```


### b)

- For hypotheses see 4.5a)
- Significance level: $\ \alpha = 5\%\ $
- Test statistic: \[ X^2 = \sum_{i,j}\frac{(o_{ij}- E_{ij})^2}{E_{ij{}}}\]
  which has a $X^2$ distribution with $(rows-1)(columns-1)$ degrees of freedom under the null hypothesis
- Observed value($\ X^2$) and P-value:

```{r 4.5b, echo=F}
result <- matrix(c(179,96,52,39,47,17,13,15,57,36,18,15), ncol = 3)
colnames(result) <-  c('won', 'lost', 'draw')
rownames(result) <- c('Bob', 'Cecilia', 'David', 'Emma')
chisq.test(result)
```
-Because the p value is not below our significance level we can not reject the null hypothesis. Andy might perform equally well against all opponents


### c)

If they play 96 games he is expected to win:

```{r 4.5c, echo=F}
round(chisq.test(result)$exp['Emma', 'won'],3)
```

# Appendix

## 4.3.a

```{r eval=FALSE, ref.label="4.3a"}
```

## 4.3.b

```{r eval=FALSE, ref.label="4.3b"}
```

## 4.3.c

```{r eval=FALSE, ref.label="4.3c"}
```

## 4.3.d

```{r eval=FALSE, ref.label="4.3d"}
```

## 4.3.e

```{r eval=FALSE, ref.label="4.3e"}
```

## 4.4.a

```{r eval=FALSE, ref.label="4.4a"}
```

## 4.4.b

```{r eval=FALSE, ref.label="4.4b"}
```

## 4.5.a

```{r eval=FALSE, ref.label="4.5a"}
```

## 4.5.b

```{r eval=FALSE, ref.label="4.5b"}
```

## 4.5.c

```{r eval=FALSE, ref.label="4.5c"}
```
